[build]
  base = "client"
  command = "npm install && npm run build && npm install --prefix ../netlify/functions"
  publish = "build"
  functions = "../netlify/functions"

# 🔹 Proxy `/cart` to Shopify's cart while keeping `rikakuma.ca/cart`
[[redirects]]
  from = "/cart"
  to = "https://vd871k-pc.myshopify.com/cart"
  status = 200
  force = true

# 🔹 API Routes for Netlify Serverless Functions
[[redirects]]
  from = "/api/cart"
  to = "/.netlify/functions/shopifyCart"
  status = 200
  force = true

[[redirects]]
  from = "/api/add-to-cart"
  to = "/.netlify/functions/addToCart"
  status = 200
  force = true

[[redirects]]
  from = "/api/remove-from-cart"
  to = "/.netlify/functions/cartRemove"
  status = 200
  force = true

# ❌ Removed the broken Shopify domain redirect

# 🔹 Catch-all for React App, must be LAST to prevent overriding `/cart`
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200